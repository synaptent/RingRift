@import "tailwindcss";

@theme {
  /* Slate color scale for dark UI backgrounds and text */
  --color-slate-50: #f8fafc;
  --color-slate-100: #f1f5f9;
  --color-slate-200: #e2e8f0;
  --color-slate-300: #cbd5e1;
  --color-slate-400: #94a3b8;
  --color-slate-500: #64748b;
  --color-slate-600: #475569;
  --color-slate-700: #334155;
  --color-slate-800: #1e293b;
  --color-slate-900: #0f172a;
  --color-slate-950: #020617;

  /* Emerald for success states, valid moves, Player 1 */
  --color-emerald-50: #ecfdf5;
  --color-emerald-100: #d1fae5;
  --color-emerald-200: #a7f3d0;
  --color-emerald-300: #6ee7b7;
  --color-emerald-400: #34d399;
  --color-emerald-500: #10b981;
  --color-emerald-600: #059669;
  --color-emerald-700: #047857;
  --color-emerald-800: #065f46;
  --color-emerald-900: #064e3b;

  /* Sky/Cyan for highlights, Player 2, AI */
  --color-sky-50: #f0f9ff;
  --color-sky-100: #e0f2fe;
  --color-sky-200: #bae6fd;
  --color-sky-300: #7dd3fc;
  --color-sky-400: #38bdf8;
  --color-sky-500: #0ea5e9;
  --color-sky-600: #0284c7;
  --color-sky-700: #0369a1;
  --color-sky-800: #075985;
  --color-sky-900: #0c4a6e;
  --color-sky-950: #082f49;

  --color-cyan-200: #a5f3fc;
  --color-cyan-400: #22d3ee;
  --color-cyan-500: #06b6d4;
  --color-cyan-600: #0891b2;

  /* Red for warnings, errors, captures */
  --color-red-50: #fef2f2;
  --color-red-100: #fee2e2;
  --color-red-200: #fecaca;
  --color-red-300: #fca5a5;
  --color-red-400: #f87171;
  --color-red-500: #ef4444;
  --color-red-600: #dc2626;
  --color-red-700: #b91c1c;
  --color-red-800: #991b1b;
  --color-red-900: #7f1d1d;

  /* Amber for warnings, timeouts, focus states */
  --color-amber-50: #fffbeb;
  --color-amber-100: #fef3c7;
  --color-amber-200: #fde68a;
  --color-amber-300: #fcd34d;
  --color-amber-400: #fbbf24;
  --color-amber-500: #f59e0b;
  --color-amber-600: #d97706;
  --color-amber-700: #b45309;
  --color-amber-800: #92400e;
  --color-amber-900: #78350f;

  /* Blue for links, secondary actions */
  --color-blue-50: #eff6ff;
  --color-blue-100: #dbeafe;
  --color-blue-200: #bfdbfe;
  --color-blue-300: #93c5fd;
  --color-blue-400: #60a5fa;
  --color-blue-500: #3b82f6;
  --color-blue-600: #2563eb;
  --color-blue-700: #1d4ed8;
  --color-blue-800: #1e40af;
  --color-blue-900: #1e3a8a;

  /* Green for Player 3, success states */
  --color-green-50: #f0fdf4;
  --color-green-100: #dcfce7;
  --color-green-200: #bbf7d0;
  --color-green-300: #86efac;
  --color-green-400: #4ade80;
  --color-green-500: #22c55e;
  --color-green-600: #16a34a;
  --color-green-700: #15803d;
  --color-green-800: #166534;
  --color-green-900: #14532d;

  /* Yellow for Player 4, highlights */
  --color-yellow-50: #fefce8;
  --color-yellow-100: #fef9c3;
  --color-yellow-200: #fef08a;
  --color-yellow-300: #fde047;
  --color-yellow-400: #facc15;
  --color-yellow-500: #eab308;
  --color-yellow-600: #ca8a04;
  --color-yellow-700: #a16207;
  --color-yellow-800: #854d0e;
  --color-yellow-900: #713f12;

  /* Gray scale for fallback */
  --color-gray-50: #f9fafb;
  --color-gray-100: #f3f4f6;
  --color-gray-200: #e5e7eb;
  --color-gray-300: #d1d5db;
  --color-gray-400: #9ca3af;
  --color-gray-500: #6b7280;
  --color-gray-600: #4b5563;
  --color-gray-700: #374151;
  --color-gray-800: #1f2937;
  --color-gray-900: #111827;
  --color-gray-950: #030712;

  /* Spacing scale */
  --spacing-px: 1px;
  --spacing-0: 0px;
  --spacing-1: 0.25rem;
  --spacing-2: 0.5rem;
  --spacing-3: 0.75rem;
  --spacing-4: 1rem;
  --spacing-5: 1.25rem;
  --spacing-6: 1.5rem;
  --spacing-8: 2rem;
  --spacing-10: 2.5rem;
  --spacing-12: 3rem;
  --spacing-16: 4rem;
  --spacing-20: 5rem;
  --spacing-24: 6rem;
  --spacing-32: 8rem;
  --spacing-40: 10rem;
  --spacing-48: 12rem;
  --spacing-56: 14rem;
  --spacing-64: 16rem;

  /* Font sizes */
  --font-size-xs: 0.75rem;
  --font-size-sm: 0.875rem;
  --font-size-base: 1rem;
  --font-size-lg: 1.125rem;
  --font-size-xl: 1.25rem;
  --font-size-2xl: 1.5rem;
  --font-size-3xl: 1.875rem;
  --font-size-4xl: 2.25rem;
  --font-size-5xl: 3rem;

  /* Font weights */
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;

  /* Border radius */
  --radius-sm: 0.125rem;
  --radius-DEFAULT: 0.25rem;
  --radius-md: 0.375rem;
  --radius-lg: 0.5rem;
  --radius-xl: 0.75rem;
  --radius-2xl: 1rem;
  --radius-3xl: 1.5rem;
  --radius-full: 9999px;

  /* Shadows */
  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --shadow-DEFAULT: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
  --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
  --shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.25);
}

/* Custom styles */
html, body {
  background-color: var(--color-slate-950);
}

body {
  margin: 0;
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Subtle background gradient for depth */
.app-bg {
  background:
    radial-gradient(ellipse 80% 60% at 20% 10%, rgba(16, 185, 129, 0.03), transparent),
    radial-gradient(ellipse 60% 50% at 80% 90%, rgba(14, 165, 233, 0.03), transparent);
}

code {
  font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',
    monospace;
}


/* Loading spinner */
.spinner {
  border: 2px solid rgba(100, 116, 139, 0.3);
  border-top: 2px solid currentColor;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

/* Spinner color variants */
.spinner-primary {
  color: #10b981; /* emerald-500 */
}

.spinner-secondary {
  color: #3b82f6; /* blue-500 */
}

.spinner-muted {
  color: #64748b; /* slate-500 */
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* ==========================================================================
   Animation CSS Custom Properties
   ========================================================================== */

:root {
  /* Animation colors for ring selection pulse */
  --ring-color-player1: 220, 38, 38;    /* red-600 RGB */
  --ring-color-player2: 37, 99, 235;    /* blue-600 RGB */
  --ring-color-player3: 22, 163, 74;    /* green-600 RGB */
  --ring-color-player4: 202, 138, 4;    /* yellow-600 RGB */
  
  /* Animation position variables (set via JS) */
  --from-x: 0px;
  --from-y: 0px;
  
  /* Animation timing */
  --move-duration: 300ms;
  --selection-duration: 1.5s;
  --capture-duration: 400ms;
  --appear-duration: 200ms;
  --celebrate-duration: 500ms;
}

/* ==========================================================================
   Game-Specific Animation Utilities
   ========================================================================== */

/* Piece movement animation helper */
.piece-moving {
  animation: piece-move var(--move-duration) ease-out forwards;
}

/* Shared selection / decision pulse used for:
   - Selected stacks (selected-piece)
   - Decision-phase board highlights (capture landings, targets, eliminations, regions)
   The pulse scales very slightly and breathes a coloured halo based on
   the current --ring-color so it remains legible on both square and hex boards. */
@keyframes selection-pulse {
  0% {
    transform: scale(1);
    box-shadow: 0 0 0 0 rgba(var(--ring-color, 56, 189, 248), 0.0);
  }
  40% {
    transform: scale(1.03);
    box-shadow: 0 0 0 4px rgba(var(--ring-color, 56, 189, 248), 0.45);
  }
  100% {
    transform: scale(1);
    box-shadow: 0 0 0 0 rgba(var(--ring-color, 56, 189, 248), 0.0);
  }
}

/* Selection states with player-specific colors */
.selected-piece {
  animation: selection-pulse var(--selection-duration) ease-in-out infinite;
}

.selected-piece.player-1 {
  --ring-color: var(--ring-color-player1);
}

.selected-piece.player-2 {
  --ring-color: var(--ring-color-player2);
}

.selected-piece.player-3 {
  --ring-color: var(--ring-color-player3);
}

.selected-piece.player-4 {
  --ring-color: var(--ring-color-player4);
}

/* Capture animation */
.capturing {
  animation: capture-bounce var(--capture-duration) ease-out;
}

/* New piece appearance */
.piece-new {
  animation: piece-appear var(--appear-duration) ease-out;
}

/* Victory celebration */
.celebrating {
  animation: celebrate var(--celebrate-duration) ease-in-out;
}

/* Valid move indicator with subtle pulse */
@keyframes move-target-pulse {
  0%, 100% {
    box-shadow: 0 0 0 0 rgba(var(--ring-color), 0);
  }
  40% {
    box-shadow: 0 0 0 3px rgba(var(--ring-color), 0.4);
  }
}

.valid-move-cell {
  /* Approximate Tailwind transition-colors-shadow duration-250 */
  transition: color 0.25s ease-in-out,
    background-color 0.25s ease-in-out,
    border-color 0.25s ease-in-out,
    box-shadow 0.25s ease-in-out;
  /* Slight, continuous pulse for legal destinations */
  animation: move-target-pulse 2.4s ease-in-out infinite;
  /* Let board-specific background classes (e.g. bg-emerald-100 on squares,
     bg-emerald-400/[0.03] on hex) control the fill colour so highlights
     stay light on both board types. */
  --ring-color: 34, 197, 94; /* green-500 RGB */
}

/* Square board: slightly deeper green pulse with more noticeable animation */
@keyframes move-target-pulse-square {
  0%, 100% {
    box-shadow: 0 0 0 0 rgba(var(--ring-color), 0);
  }
  50% {
    box-shadow: 0 0 0 5px rgba(var(--ring-color), 0.55);
  }
}

.valid-move-cell-square {
  animation: move-target-pulse-square 1.8s ease-in-out infinite;
  --ring-color: 16, 185, 129; /* emerald-500 RGB for deeper green */
}

/* Decision-phase pulses for board-level choices */
.decision-pulse-capture {
  position: relative;
  animation: selection-pulse 1.8s ease-in-out infinite;
  /* Deeper light green overlay for capture landings so they read as
     high-value, rules-driven destinations without becoming fully dark. */
  background-image: radial-gradient(
    circle at center,
    rgba(16, 185, 129, 0.24),
    rgba(16, 185, 129, 0.14) 45%,
    transparent 72%
  );
  box-shadow:
    0 0 0 1px rgba(16, 185, 129, 0.85),
    0 0 16px rgba(6, 95, 70, 0.9);
  --ring-color: 16, 185, 129; /* emerald-500 RGB */
}

.decision-pulse-capture::before {
  content: "";
  position: absolute;
  /* Slight inward offset so the amber ring sits comfortably inside the
     square/hex outline rather than hugging the edges. */
  inset: 4px;
  border-radius: inherit;
  pointer-events: none;
  box-shadow:
    0 0 0 2px rgba(251, 191, 36, 0.9),
    0 0 10px rgba(251, 191, 36, 0.6);
}

/* Capture target pulse: emphasise the overtaken stack with a distinct
   amber ring and lighter fill so it is visually separate from landing
   cells while still pulsing. */
.capture-target-pulse {
  position: relative;
  animation: selection-pulse 1.6s ease-in-out infinite;
  --ring-color: 251, 191, 36; /* amber-300/400 RGB */
  box-shadow:
    0 0 0 1px rgba(251, 191, 36, 0.85),
    0 0 12px rgba(251, 191, 36, 0.7);
}

.capture-target-pulse::before {
  content: "";
  position: absolute;
  inset: 5px;
  border-radius: inherit;
  pointer-events: none;
  box-shadow:
    0 0 0 2px rgba(251, 191, 36, 0.95),
    0 0 8px rgba(251, 191, 36, 0.7);
}

.decision-pulse-elimination {
  animation: selection-pulse 1.6s ease-in-out infinite;
  --ring-color: 251, 191, 36; /* amber-300/400 RGB */
  /* Amber inner halo used for elimination choices. The halo is slightly
     inset from the outer border so it appears as a thicker inner ring
     rather than a full cell fill, and remains legible on both square
     and hex boards.
     RR-UX-2026-01-10: Increased intensity by ~80% for better visibility. */
  position: relative;
  background-image: radial-gradient(
    circle at center,
    rgba(251, 191, 36, 0.4),
    rgba(251, 191, 36, 0.15) 50%,
    transparent 70%
  );
  box-shadow:
    0 0 0 3px rgba(251, 191, 36, 0.95),
    0 0 24px 5px rgba(251, 191, 36, 0.5);
}

.decision-pulse-elimination::before {
  content: "";
  position: absolute;
  inset: 3px; /* inset to avoid touching the outer border */
  border-radius: inherit;
  pointer-events: none;
  box-shadow:
    0 0 0 2px rgba(251, 191, 36, 0.95),
    0 0 14px rgba(251, 191, 36, 0.85);
}

.decision-pulse-territory {
  position: relative;
  animation: selection-pulse 1.2s ease-in-out infinite;
  /* Neutral teal base glow so territory regions read as a distinct
     decision state compared to captures/eliminations and generic
     decision highlights. Per-region classes add their own colour
     accents on top of this pulse.
     RR-UX-2026-01-10: Increased intensity by 50% for better visibility. */
  --ring-color: 45, 212, 191; /* teal-400 RGB */
  background-image: radial-gradient(
    circle at center,
    rgba(45, 212, 191, 0.25),
    rgba(45, 212, 191, 0.1) 50%,
    transparent 70%
  );
  box-shadow:
    0 0 0 2px rgba(45, 212, 191, 0.95),
    0 0 24px 4px rgba(45, 212, 191, 0.4),
    0 0 8px rgba(15, 23, 42, 0.95);
}

/* Territory region palette: each region gets a distinct, high-contrast
   halo so multiple choices are immediately recognisable. Overlaps use
   a dedicated multi-colour style. These classes are applied in addition
   to .decision-pulse-territory. */

.territory-region-a::before,
.territory-region-b::before,
.territory-region-c::before,
.territory-region-d::before,
.territory-region-overlap::before {
  content: "";
  position: absolute;
  inset: 3px;
  border-radius: inherit;
  pointer-events: none;
}

.territory-region-a::before {
  /* Cyan / teal - increased intensity by 50% */
  background-image: radial-gradient(
    circle at center,
    rgba(34, 211, 238, 0.45),
    rgba(34, 211, 238, 0.15) 50%,
    transparent 70%
  );
  box-shadow:
    0 0 0 3px rgba(34, 211, 238, 0.95),
    0 0 28px 4px rgba(34, 211, 238, 0.5);
}

.territory-region-b::before {
  /* Rose / magenta - increased intensity by 50% */
  background-image: radial-gradient(
    circle at center,
    rgba(244, 114, 182, 0.48),
    rgba(244, 114, 182, 0.16) 50%,
    transparent 70%
  );
  box-shadow:
    0 0 0 3px rgba(244, 114, 182, 0.95),
    0 0 28px 4px rgba(244, 114, 182, 0.5);
}

.territory-region-c::before {
  /* Amber / gold - increased intensity by 50% */
  background-image: radial-gradient(
    circle at center,
    rgba(251, 191, 36, 0.48),
    rgba(251, 191, 36, 0.16) 50%,
    transparent 70%
  );
  box-shadow:
    0 0 0 3px rgba(251, 191, 36, 0.95),
    0 0 30px 4px rgba(251, 191, 36, 0.5);
}

.territory-region-d::before {
  /* Violet / indigo - increased intensity by 50% */
  background-image: radial-gradient(
    circle at center,
    rgba(167, 139, 250, 0.48),
    rgba(167, 139, 250, 0.16) 50%,
    transparent 70%
  );
  box-shadow:
    0 0 0 3px rgba(167, 139, 250, 0.95),
    0 0 30px 4px rgba(167, 139, 250, 0.5);
}

.territory-region-overlap::before {
  /* Multi-colour blend for cells that belong to more than one region.
     Use concentric, slightly offset glows so the overlap is visually
     distinct from any single-region style. */
  background-image:
    radial-gradient(circle at center, rgba(34, 211, 238, 0.32), transparent 55%),
    radial-gradient(circle at center, rgba(244, 114, 182, 0.26), transparent 78%);
  box-shadow:
    0 0 0 2px rgba(247, 254, 231, 0.95),
    0 0 26px rgba(56, 189, 248, 0.9),
    0 0 32px rgba(244, 114, 182, 0.9);
}

/* ==========================================================================
   RR-FIX-2026-01-12: Line Segment Highlighting for Overlength Line Choices
   ========================================================================== */

/* Base decision pulse for line reward choices */
.decision-pulse-line-reward {
  position: relative;
  animation: selection-pulse 1.4s ease-in-out infinite;
  --ring-color: 251, 191, 36; /* amber-400 RGB */
}

/* Collapse-all segment: Amber glow indicating ring elimination cost */
.line-segment-collapse-all {
  position: relative;
  animation: selection-pulse 1.4s ease-in-out infinite;
  --ring-color: 251, 191, 36; /* amber-400 RGB */
  background-image: radial-gradient(
    circle at center,
    rgba(251, 191, 36, 0.3),
    rgba(251, 191, 36, 0.12) 50%,
    transparent 75%
  );
  box-shadow:
    0 0 0 2px rgba(251, 191, 36, 0.9),
    0 0 16px 2px rgba(251, 191, 36, 0.5);
}

.line-segment-collapse-all::before {
  content: "";
  position: absolute;
  inset: 3px;
  border-radius: inherit;
  pointer-events: none;
  box-shadow:
    0 0 0 2px rgba(251, 191, 36, 0.85),
    0 0 10px rgba(251, 191, 36, 0.7);
}

/* Minimum collapse segment 1: Cyan glow (free, no elimination) */
.line-segment-min-1 {
  position: relative;
  animation: selection-pulse 1.4s ease-in-out infinite;
  --ring-color: 34, 211, 238; /* cyan-400 RGB */
  background-image: radial-gradient(
    circle at center,
    rgba(34, 211, 238, 0.28),
    rgba(34, 211, 238, 0.1) 50%,
    transparent 75%
  );
  box-shadow:
    0 0 0 2px rgba(34, 211, 238, 0.9),
    0 0 16px 2px rgba(34, 211, 238, 0.5);
}

.line-segment-min-1::before {
  content: "";
  position: absolute;
  inset: 3px;
  border-radius: inherit;
  pointer-events: none;
  box-shadow:
    0 0 0 2px rgba(34, 211, 238, 0.85),
    0 0 10px rgba(34, 211, 238, 0.7);
}

/* Minimum collapse segment 2: Emerald glow */
.line-segment-min-2 {
  position: relative;
  animation: selection-pulse 1.4s ease-in-out infinite;
  --ring-color: 52, 211, 153; /* emerald-400 RGB */
  background-image: radial-gradient(
    circle at center,
    rgba(52, 211, 153, 0.28),
    rgba(52, 211, 153, 0.1) 50%,
    transparent 75%
  );
  box-shadow:
    0 0 0 2px rgba(52, 211, 153, 0.9),
    0 0 16px 2px rgba(52, 211, 153, 0.5);
}

.line-segment-min-2::before {
  content: "";
  position: absolute;
  inset: 3px;
  border-radius: inherit;
  pointer-events: none;
  box-shadow:
    0 0 0 2px rgba(52, 211, 153, 0.85),
    0 0 10px rgba(52, 211, 153, 0.7);
}

/* Minimum collapse segment 3: Violet glow */
.line-segment-min-3 {
  position: relative;
  animation: selection-pulse 1.4s ease-in-out infinite;
  --ring-color: 167, 139, 250; /* violet-400 RGB */
  background-image: radial-gradient(
    circle at center,
    rgba(167, 139, 250, 0.28),
    rgba(167, 139, 250, 0.1) 50%,
    transparent 75%
  );
  box-shadow:
    0 0 0 2px rgba(167, 139, 250, 0.9),
    0 0 16px 2px rgba(167, 139, 250, 0.5);
}

.line-segment-min-3::before {
  content: "";
  position: absolute;
  inset: 3px;
  border-radius: inherit;
  pointer-events: none;
  box-shadow:
    0 0 0 2px rgba(167, 139, 250, 0.85),
    0 0 10px rgba(167, 139, 250, 0.7);
}

/* Line context: Secondary highlight for non-collapsing line positions */
.line-segment-context {
  position: relative;
  animation: selection-pulse 2s ease-in-out infinite;
  --ring-color: 148, 163, 184; /* slate-400 RGB */
  background-image: radial-gradient(
    circle at center,
    rgba(148, 163, 184, 0.15),
    transparent 60%
  );
  box-shadow:
    0 0 0 1px rgba(148, 163, 184, 0.5),
    0 0 8px rgba(148, 163, 184, 0.3);
}

/* Stack-level pulse for elimination choices so the stack itself breathes.
   Enhanced visibility with stronger glow and faster pulse for urgency. */
.decision-elimination-stack-pulse {
  animation: selection-pulse 1.4s ease-in-out infinite;
  --ring-color: 251, 191, 36; /* amber-300/400 RGB */
  filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.7)) drop-shadow(0 0 16px rgba(251, 191, 36, 0.4));
}

/* ==========================================================================
   Invalid Move Feedback Animation
   ========================================================================== */

/* Subtle shake animation for invalid move attempts */
@keyframes invalid-move-shake {
  0%, 100% {
    transform: translateX(0);
  }
  10%, 30%, 50%, 70%, 90% {
    transform: translateX(-3px);
  }
  20%, 40%, 60%, 80% {
    transform: translateX(3px);
  }
}

/* Cell shake animation when an invalid move is attempted */
.invalid-move-shake {
  animation: invalid-move-shake 0.4s ease-in-out;
  box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.6), /* red-500 with alpha */
              0 0 8px rgba(239, 68, 68, 0.4);
}

/* Briefly tint the cell red during shake to reinforce the invalid state */
.invalid-move-shake::after {
  content: "";
  position: absolute;
  inset: 0;
  background: rgba(239, 68, 68, 0.15);
  border-radius: inherit;
  pointer-events: none;
  animation: invalid-move-flash 0.4s ease-out forwards;
}

@keyframes invalid-move-flash {
  0% {
    opacity: 0.8;
  }
  100% {
    opacity: 0;
  }
}

/* Board-level shake for more severe invalid move attempts */
.board-shake {
  animation: board-shake 0.35s ease-in-out;
}

@keyframes board-shake {
  0%, 100% {
    transform: translateX(0) rotate(0);
  }
  20%, 60% {
    transform: translateX(-2px) rotate(-0.5deg);
  }
  40%, 80% {
    transform: translateX(2px) rotate(0.5deg);
  }
}

/* --------------------------------------------------------------------------
   Decision-phase board highlights
   -------------------------------------------------------------------------- */

/* Primary decision highlight: strong cyan/teal glow around the cell that
   remains visually distinct from the emerald valid-move tint. We avoid using
   outline so it can stack cleanly with valid-move styling when both apply. */
.decision-highlight-primary {
  box-shadow:
    0 0 0 2px rgba(34, 211, 238, 0.85),  /* border-like glow (cyan-400) */
    0 0 14px 2px rgba(8, 47, 73, 0.9);   /* deep inner glow (sky-950) */
  background-image: radial-gradient(circle at center, rgba(34, 211, 238, 0.16), transparent 60%);
}

/* Secondary decision highlight: lighter, more subtle version used for
   secondary geometry (e.g., capture targets vs landing squares). */
.decision-highlight-secondary {
  box-shadow:
    0 0 0 1px rgba(56, 189, 248, 0.6),  /* thin glow (sky-400) */
    0 0 10px 1px rgba(15, 23, 42, 0.6);  /* slate-900 soft focus */
  background-image: radial-gradient(circle at center, rgba(56, 189, 248, 0.10), transparent 60%);
}

/* Brief destination pulse when a move completes. Applied to the cell that
   matches the last move's landing position while the move animation is
   active. */
@keyframes move-destination-pulse-scale {
  0% {
    transform: scale(1.06);
    opacity: 0.0;
  }
  35% {
    transform: scale(1.04);
    opacity: 1;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

.move-destination-pulse {
  animation: move-destination-pulse-scale 260ms ease-out;
}

/* Brief celebratory burst for cells that are part of a newly completed line.
   Applied on top of decision highlights for line-related decisions so that
   line geometry stands out clearly without overwhelming other overlays. */
@keyframes line-formation-burst {
  0% {
    outline-width: 0px;
    outline-color: rgba(251, 191, 36, 0);
    outline-offset: 0px;
  }
  35% {
    outline-width: 4px;
    outline-color: rgba(251, 191, 36, 0.95); /* amber-300/400 */
    outline-offset: 2px;
  }
  100% {
    outline-width: 0px;
    outline-color: rgba(251, 191, 36, 0);
    outline-offset: 0px;
  }
}

.line-formation-burst {
  animation: line-formation-burst 650ms ease-out;
}

/* --------------------------------------------------------------------------
   Sandbox rules-lab overlays (lines, territory regions)
   -------------------------------------------------------------------------- */

/* Generic line overlay: subtle ring and glow drawn via ::after so it can
   stack with valid-move and decision highlights. Player-specific tints are
   applied via data-line-overlay-player. */
[data-line-overlay="true"]::after {
  content: "";
  position: absolute;
  inset: 3px;
  border-radius: 9999px;
  border-width: 2px;
  border-style: solid;
  border-color: rgba(148, 163, 184, 0.95); /* slate-400 fallback */
  box-shadow:
    0 0 6px rgba(15, 23, 42, 0.9),
    0 0 12px rgba(15, 23, 42, 0.9);
  pointer-events: none;
}

[data-line-overlay-player="1"]::after {
  border-color: rgba(52, 211, 153, 0.98); /* emerald-400 */
}

[data-line-overlay-player="2"]::after {
  border-color: rgba(56, 189, 248, 0.98); /* sky-400 */
}

[data-line-overlay-player="3"]::after {
  border-color: rgba(250, 204, 21, 0.98); /* yellow-400 */
}

[data-line-overlay-player="4"]::after {
  border-color: rgba(244, 114, 182, 0.98); /* fuchsia-400-ish */
}

/* Territory / disconnected-region overlays use ::before so they can sit
   underneath markers and stacks but above the base square/hex fill. */
[data-region-overlay="true"]::before {
  content: "";
  position: absolute;
  inset: 2px;
  border-radius: inherit;
  background: radial-gradient(circle at center, rgba(15, 118, 110, 0.22), transparent 70%);
  mix-blend-mode: soft-light;
  pointer-events: none;
}

[data-region-overlay-player="1"]::before {
  background: radial-gradient(circle at center, rgba(16, 185, 129, 0.22), transparent 70%);
}

[data-region-overlay-player="2"]::before {
  background: radial-gradient(circle at center, rgba(56, 189, 248, 0.22), transparent 70%);
}

[data-region-overlay-player="3"]::before {
  background: radial-gradient(circle at center, rgba(250, 204, 21, 0.22), transparent 70%);
}

[data-region-overlay-player="4"]::before {
  background: radial-gradient(circle at center, rgba(244, 114, 182, 0.22), transparent 70%);
}

[data-region-overlay-disconnected="true"]::before {
  outline: 1px dashed rgba(248, 250, 252, 0.8); /* slate-50 */
  outline-offset: -2px;
}

/* Smooth position transitions for drag/drop */
.position-transition {
  transition: left 0.3s cubic-bezier(0.34, 1.56, 0.64, 1),
    top 0.3s cubic-bezier(0.34, 1.56, 0.64, 1),
    transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* Hover state improvements */
.interactive-piece {
  transition: transform 0.2s ease-out;
}

.interactive-piece:hover {
  transform: scale(1.08);
}

/* Disabled/non-interactive state */
.non-interactive {
  pointer-events: none;
  opacity: 0.6;
}

/* ==========================================================================
   Victory Modal Celebration Animations
   ========================================================================== */

/* Modal backdrop fade-in */
@keyframes modal-fade-in {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}

.modal-backdrop-animate {
  animation: modal-fade-in 300ms ease-out forwards;
}

/* Modal content slide-up and scale */
@keyframes modal-entrance {
  0% {
    opacity: 0;
    transform: scale(0.9) translateY(20px);
  }
  100% {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.modal-content-animate {
  animation: modal-entrance 400ms ease-out forwards;
}

/* Trophy bounce animation */
@keyframes trophy-bounce {
  0%, 100% {
    transform: scale(1) rotate(0deg);
  }
  15% {
    transform: scale(1.2) rotate(-10deg);
  }
  30% {
    transform: scale(1.15) rotate(10deg);
  }
  45% {
    transform: scale(1.1) rotate(-5deg);
  }
  60% {
    transform: scale(1.05) rotate(5deg);
  }
  75% {
    transform: scale(1.02) rotate(-2deg);
  }
}

.trophy-animate {
  animation: trophy-bounce 800ms ease-out forwards;
  display: inline-block;
}

/* Winner text entrance */
@keyframes winner-text-entrance {
  0% {
    opacity: 0;
    transform: translateY(-10px) scale(0.95);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.winner-text-animate {
  animation: winner-text-entrance 400ms ease-out forwards;
  animation-delay: 200ms;
  opacity: 0;
}

/* Stats section fade-in */
@keyframes stats-fade-in {
  0% {
    opacity: 0;
    transform: translateY(10px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

.stats-animate {
  animation: stats-fade-in 400ms ease-out forwards;
  animation-delay: 400ms;
  opacity: 0;
}

.summary-animate {
  animation: stats-fade-in 400ms ease-out forwards;
  animation-delay: 500ms;
  opacity: 0;
}

.buttons-animate {
  animation: stats-fade-in 400ms ease-out forwards;
  animation-delay: 600ms;
  opacity: 0;
}

/* Confetti particle animations */
@keyframes confetti-fall-1 {
  0% {
    opacity: 0;
    transform: translateY(-100%) rotate(0deg);
  }
  10% {
    opacity: 1;
  }
  100% {
    opacity: 0;
    transform: translateY(400%) rotate(720deg);
  }
}

@keyframes confetti-fall-2 {
  0% {
    opacity: 0;
    transform: translateY(-100%) translateX(-20px) rotate(0deg);
  }
  10% {
    opacity: 1;
  }
  100% {
    opacity: 0;
    transform: translateY(450%) translateX(30px) rotate(-540deg);
  }
}

@keyframes confetti-fall-3 {
  0% {
    opacity: 0;
    transform: translateY(-100%) translateX(10px) rotate(0deg);
  }
  10% {
    opacity: 1;
  }
  100% {
    opacity: 0;
    transform: translateY(500%) translateX(-40px) rotate(900deg);
  }
}

.confetti-particle {
  position: absolute;
  font-size: 1.5rem;
  pointer-events: none;
  z-index: 10;
}

.confetti-1 { animation: confetti-fall-1 3s ease-out forwards; left: 10%; top: 0; animation-delay: 0ms; }
.confetti-2 { animation: confetti-fall-2 3.2s ease-out forwards; left: 25%; top: 0; animation-delay: 100ms; }
.confetti-3 { animation: confetti-fall-3 2.8s ease-out forwards; left: 40%; top: 0; animation-delay: 200ms; }
.confetti-4 { animation: confetti-fall-1 3.5s ease-out forwards; left: 55%; top: 0; animation-delay: 150ms; }
.confetti-5 { animation: confetti-fall-2 3s ease-out forwards; left: 70%; top: 0; animation-delay: 50ms; }
.confetti-6 { animation: confetti-fall-3 3.3s ease-out forwards; left: 85%; top: 0; animation-delay: 250ms; }
.confetti-7 { animation: confetti-fall-1 2.9s ease-out forwards; left: 15%; top: 0; animation-delay: 300ms; }
.confetti-8 { animation: confetti-fall-2 3.1s ease-out forwards; left: 60%; top: 0; animation-delay: 350ms; }

/* Victory shimmer gradient effect */
@keyframes shimmer {
  0% {
    background-position: -200% center;
  }
  100% {
    background-position: 200% center;
  }
}

.victory-shimmer {
  background: linear-gradient(
    90deg,
    transparent 0%,
    rgba(255, 215, 0, 0.1) 25%,
    rgba(255, 215, 0, 0.2) 50%,
    rgba(255, 215, 0, 0.1) 75%,
    transparent 100%
  );
  background-size: 200% 100%;
  animation: shimmer 3s ease-in-out infinite;
}

/* Glow effect for winner */
@keyframes winner-glow {
  0%, 100% {
    text-shadow: 0 0 10px currentColor, 0 0 20px currentColor;
  }
  50% {
    text-shadow: 0 0 20px currentColor, 0 0 40px currentColor, 0 0 60px currentColor;
  }
}

.winner-glow {
  animation: winner-glow 2s ease-in-out infinite;
}

/* ==========================================================================
   Accessibility Utilities
   ========================================================================== */

/* Screen reader only - hides visually but keeps accessible to screen readers */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Keyboard focus indicator for board cells - amber color distinct from selection */
.board-cell-focused {
  outline: 2px solid #f59e0b;
  outline-offset: 2px;
  box-shadow: 0 0 0 4px rgba(245, 158, 11, 0.3);
}

/* Enhanced focus visibility for buttons and interactive elements */
button:focus-visible,
[role="gridcell"]:focus-visible,
[role="option"]:focus-visible {
  outline: 2px solid #f59e0b;
  outline-offset: 2px;
  box-shadow: 0 0 0 4px rgba(245, 158, 11, 0.25);
}

/* Focus styles for dialog options */
[role="option"]:focus {
  outline: 2px solid #f59e0b;
  outline-offset: 1px;
}

/* Focus ring for links and anchors */
a:focus-visible {
  outline: 2px solid #f59e0b;
  outline-offset: 2px;
  border-radius: 2px;
}

/* Skip link for keyboard users - visible only on focus */
.skip-link {
  position: absolute;
  top: -40px;
  left: 0;
  background: #1e293b;
  color: #f8fafc;
  padding: 8px 16px;
  z-index: 100;
  text-decoration: none;
  font-weight: 600;
  border-radius: 0 0 4px 0;
  transition: top 0.2s ease;
}

.skip-link:focus {
  top: 0;
  outline: 2px solid #f59e0b;
  outline-offset: 2px;
}

/* High contrast focus mode support */
@media (prefers-contrast: high) {
  button:focus-visible,
  [role="gridcell"]:focus-visible,
  [role="option"]:focus-visible,
  a:focus-visible {
    outline: 3px solid currentColor;
    outline-offset: 3px;
    box-shadow: none;
  }
  
  .skip-link:focus {
    outline: 3px solid currentColor;
  }
}

/* Reduce motion for users who prefer it */
@media (prefers-reduced-motion: reduce) {
  .valid-move-cell,
  .selected-piece,
  .piece-moving,
  .capturing,
  .piece-new,
  .celebrating {
    animation: none;
  }
  
  .position-transition,
  .interactive-piece {
    transition: none;
  }
  
  .skip-link {
    transition: none;
  }
}

/* ==========================================================================
   Keyboard Shortcuts Help Styles
   ========================================================================== */

/* Keyboard key styling */
kbd {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 24px;
  height: 24px;
  padding: 2px 6px;
  font-family: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, monospace;
  font-size: 0.75rem;
  font-weight: 600;
  line-height: 1;
  color: #e2e8f0;
  background: linear-gradient(180deg, #475569 0%, #334155 100%);
  border: 1px solid #64748b;
  border-radius: 4px;
  box-shadow: 0 2px 0 #1e293b, inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

/* ==========================================================================
   Mobile Viewport Handling (W3-12)
   ========================================================================== */

/* Board scroll container for mobile viewports.
   - Square8: 8×44px cells + 7×2px gaps = 366px fits in 375px viewport
   - Square19: 19×44px cells + 18×2px gaps = 872px requires horizontal scroll
   - Hexagonal: varies, may need scroll on mobile */
.board-scroll-container {
  overflow-x: auto;
  overflow-y: hidden;
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
  /* Prevent pull-to-refresh on mobile */
  overscroll-behavior-x: contain;
  /* Hide scrollbar for cleaner look but keep functionality */
  scrollbar-width: thin;
  scrollbar-color: rgba(148, 163, 184, 0.4) transparent;
}

.board-scroll-container::-webkit-scrollbar {
  height: 6px;
}

.board-scroll-container::-webkit-scrollbar-track {
  background: transparent;
}

.board-scroll-container::-webkit-scrollbar-thumb {
  background: rgba(148, 163, 184, 0.4);
  border-radius: 3px;
}

.board-scroll-container::-webkit-scrollbar-thumb:hover {
  background: rgba(148, 163, 184, 0.6);
}

/* Mobile-only horizontal scroll indicator */
@media (max-width: 639px) {
  .board-scroll-container.needs-scroll::after {
    content: "";
    position: absolute;
    right: 0;
    top: 0;
    bottom: 0;
    width: 24px;
    background: linear-gradient(
      to left,
      rgba(15, 23, 42, 0.8),
      transparent
    );
    pointer-events: none;
    opacity: 1;
    transition: opacity 0.3s ease;
  }

  .board-scroll-container.scrolled-right::after {
    opacity: 0;
  }
}

/* Touch-friendly tap targets - minimum 44px (WCAG 2.1 AAA) */
@media (max-width: 767px) {
  /* Ensure board cells meet touch target requirements */
  [role="gridcell"] {
    min-width: 44px;
    min-height: 44px;
  }

  /* Increase tap area for interactive elements */
  .interactive-piece {
    /* Extend hit area without changing visual size */
    position: relative;
  }

  .interactive-piece::before {
    content: "";
    position: absolute;
    inset: -4px;
    z-index: -1;
  }
}

/* Viewport height handling for mobile browsers (address bar) */
@supports (height: 100dvh) {
  .game-container-mobile {
    height: 100dvh;
    max-height: 100dvh;
  }
}

/* Fallback for browsers without dvh support */
@supports not (height: 100dvh) {
  .game-container-mobile {
    height: 100vh;
    max-height: -webkit-fill-available;
  }
}

/* Prevent text selection during drag on mobile */
.board-container {
  -webkit-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
}

/* Mobile landscape orientation adjustments */
@media (max-width: 767px) and (orientation: landscape) {
  .game-layout-mobile {
    flex-direction: row;
  }

  .board-scroll-container {
    max-height: calc(100dvh - 60px);
  }
}

/* ==========================================================================
   Touch Interaction Enhancements (W3-13)
   ========================================================================== */

/* Touch-friendly tap feedback for board cells */
@media (pointer: coarse) {
  /* Active state feedback for touch */
  [role="gridcell"]:active {
    transform: scale(0.95);
    transition: transform 0.1s ease-out;
  }

  /* Prevent double-tap zoom on interactive elements */
  [role="gridcell"],
  .touch-manipulation {
    touch-action: manipulation;
  }

  /* Improve tap highlight for stack interactions */
  .interactive-piece:active {
    transform: scale(0.92);
    transition: transform 0.1s ease-out;
  }

  /* Visual feedback ring on touch */
  [role="gridcell"]::after {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    pointer-events: none;
    opacity: 0;
    background: radial-gradient(circle, rgba(255, 255, 255, 0.2) 0%, transparent 70%);
    transition: opacity 0.15s ease-out;
  }

  [role="gridcell"]:active::after {
    opacity: 1;
  }
}

/* Disable hover states on touch devices to avoid sticky hover */
@media (hover: none) and (pointer: coarse) {
  .interactive-piece:hover {
    transform: none;
  }

  button:hover {
    /* Reset hover states on mobile */
  }
}

/* Ensure touch targets have proper spacing */
@media (max-width: 767px) {
  /* Add gap between tappable player rows */
  .space-y-1 > button {
    margin-bottom: 8px;
  }

  /* Increase touch area for small buttons */
  button[class*="rounded-full"] {
    min-width: 44px;
    min-height: 44px;
  }
}

/* ==========================================================================
   Long-Press Visual Feedback (W3-14)
   ========================================================================== */

/* Visual feedback ring that appears during long-press on touch devices */
@keyframes long-press-indicator {
  0% {
    transform: scale(0.5);
    opacity: 0;
  }
  50% {
    transform: scale(0.9);
    opacity: 0.6;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

/* Long-press progress indicator - grows as user holds */
@keyframes long-press-progress {
  0% {
    stroke-dashoffset: 100;
  }
  100% {
    stroke-dashoffset: 0;
  }
}

/* Cell info tooltip animation for touch devices */
@keyframes cell-info-appear {
  0% {
    opacity: 0;
    transform: translateY(8px) scale(0.95);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.cell-info-tooltip {
  animation: cell-info-appear 200ms ease-out forwards;
}

/* Touch-friendly info badge shown on long-press */
.touch-info-badge {
  position: fixed;
  bottom: env(safe-area-inset-bottom, 20px);
  left: 50%;
  transform: translateX(-50%);
  z-index: 1000;
  max-width: 90vw;
  animation: cell-info-appear 200ms ease-out forwards;
}

/* Safe area padding for notches and home indicators */
@supports (padding: env(safe-area-inset-bottom)) {
  .safe-area-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }
  
  .safe-area-top {
    padding-top: env(safe-area-inset-top);
  }
}
