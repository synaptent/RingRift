{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "name": "RingRift Target Scale Test",
  "description": "Validate system at production target: 100 concurrent games with 300 players",
  "version": "1.0.0",
  "lastRun": null,
  "lastUpdated": "2025-12-07",

  "targets": {
    "concurrent_games": 100,
    "concurrent_players": 300,
    "players_per_game": 3
  },

  "testPhases": [
    {
      "name": "warmup",
      "duration": "2m",
      "targetVUs": 30,
      "targetGames": 10,
      "description": "Warm up the system and fill caches"
    },
    {
      "name": "rampToHalf",
      "duration": "5m",
      "targetVUs": 150,
      "targetGames": 50,
      "description": "Ramp to 50% of target capacity"
    },
    {
      "name": "steadyHalf",
      "duration": "5m",
      "targetVUs": 150,
      "targetGames": 50,
      "description": "Hold at 50% for stabilization and measurement"
    },
    {
      "name": "rampToFull",
      "duration": "5m",
      "targetVUs": 300,
      "targetGames": 100,
      "description": "Ramp to full production target"
    },
    {
      "name": "steadyFull",
      "duration": "10m",
      "targetVUs": 300,
      "targetGames": 100,
      "description": "Hold at full capacity for validation"
    },
    {
      "name": "rampDown",
      "duration": "3m",
      "targetVUs": 0,
      "targetGames": 0,
      "description": "Graceful ramp down to avoid connection errors"
    }
  ],

  "thresholds": {
    "http_req_duration": {
      "p95": 500,
      "p99": 2000,
      "description": "HTTP request latency thresholds (ms)"
    },
    "http_req_failed": {
      "rate": 0.01,
      "description": "Maximum acceptable HTTP error rate (1%)"
    },
    "ws_connecting": {
      "p95": 1000,
      "description": "WebSocket connection establishment time (ms)"
    },
    "game_creation_time": {
      "p95": 2000,
      "description": "Time to create a new game (ms)"
    },
    "move_latency": {
      "p95": 500,
      "description": "End-to-end move submission latency (ms)"
    },
    "concurrent_games": {
      "min": 100,
      "description": "Minimum concurrent games to validate"
    },
    "concurrent_players": {
      "min": 300,
      "description": "Minimum concurrent players to validate"
    }
  },

  "breakpoints": {
    "abort_on_error_rate": 0.05,
    "abort_on_latency_p95_ms": 2000,
    "description": "Conditions that will abort the test early"
  },

  "metrics": {
    "capacity": {
      "metrics": ["max_concurrent_games", "max_concurrent_vus", "throughput_rps"],
      "description": "Core capacity indicators"
    },
    "latency": {
      "percentiles": ["p50", "p95", "p99", "max"],
      "description": "Latency distribution metrics"
    },
    "errors": {
      "metrics": ["rate", "count", "types"],
      "description": "Error tracking metrics"
    },
    "classification": {
      "metrics": ["contract_failures", "capacity_failures", "lifecycle_mismatches"],
      "description": "Failure classification for root cause analysis"
    }
  },

  "scenarios": {
    "concurrent_games": {
      "enabled": true,
      "weight": 0.5,
      "description": "Test concurrent game creation and state management at scale"
    },
    "websocket_stress": {
      "enabled": true,
      "weight": 0.3,
      "description": "WebSocket connection handling under production load"
    },
    "player_moves": {
      "enabled": true,
      "weight": 0.2,
      "description": "Move submission throughput with 300 concurrent players"
    }
  },

  "resourceRequirements": {
    "minMemory_gb": 8,
    "recommendedMemory_gb": 16,
    "minCPU_cores": 4,
    "recommendedCPU_cores": 8,
    "description": "Resource requirements for running target scale test"
  },

  "outputConfig": {
    "resultsDir": "tests/load/results",
    "summaryFormat": "json",
    "includeRawMetrics": true,
    "archiveResults": true,
    "timestampFormat": "YYYYMMDD_HHmmss"
  },

  "integrations": {
    "prometheus": {
      "enabled": true,
      "endpoint": "/metrics",
      "scrapeInterval": "15s"
    },
    "grafana": {
      "dashboardId": "ringrift-target-scale-test",
      "annotateRuns": true
    }
  }
}
