# Rules Concepts Index – High-Risk Rules UX

> **Doc status (2025‑12‑05): Canonical navigation index for high‑risk rules concepts.**

## 1. Introduction

This index is derived from the weakest‑aspect analysis in [`WEAKNESS_AND_HARDEST_PROBLEM_REPORT.md`](../archive/assessments/WEAKNESS_AND_HARDEST_PROBLEM_REPORT.md), which identifies **rules UX and onboarding** as RingRift’s weakest area despite strong underlying rules semantics and engine parity. It focuses on the same cluster of problematic topics: Active‑No‑Moves & forced elimination, structural stalemates, territory mini‑regions, capture chains, Last‑Player‑Standing, and line‑vs‑territory ordering.

The goal is to provide a single **navigation map** for these high‑risk concepts, aligning:

- Canonical rules semantics and clarifications.
- UX / teaching specs and in‑client surfaces (HUD, VictoryModal, TeachingOverlay, sandbox).
- Telemetry concepts and focused scenario/tests.

This document **does not redefine any rules**. For normative semantics, always defer to [`RULES_CANONICAL_SPEC.md`](../../RULES_CANONICAL_SPEC.md) and [`../rules/COMPLETE_RULES.md`](../rules/COMPLETE_RULES.md). The index exists to answer “where is X explained, implemented, surfaced, and telemetried?” as quickly as possible.

## 2. High‑Risk Rules Concepts

### 2.1 Concepts table

| Concept ID                   | Display name                                        | Brief description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Canonical rules docs                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | UX & teaching docs                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Engine / UX implementation touchpoints                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Telemetry / tests                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ---------------------------- | --------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `anm_fe_core`                | Active‑No‑Moves & Forced Elimination (ANM/FE)       | Situations where a player controls stacks but has **no legal placements, moves, or captures**, so caps are forcibly eliminated until a real move becomes available or stacks are gone. Central to progress guarantees and many “I lost rings for no reason” complaints.                                                                                                                                                                                                                                                                                                                                                                                      | [`RULES_CANONICAL_SPEC.md`](../../RULES_CANONICAL_SPEC.md) R072 (turn/phase) and [`RULES_CANONICAL_SPEC.md`](../../RULES_CANONICAL_SPEC.md) R100 (forced elimination) and R2xx ANM cluster.<br>[`../rules/COMPLETE_RULES.md`](../rules/COMPLETE_RULES.md) §4.4 Forced Elimination When Blocked; [`../rules/COMPLETE_RULES.md`](../rules/COMPLETE_RULES.md) §13.3 Last Player Standing (real actions vs FE).<br>[`docs/rules/ACTIVE_NO_MOVES_BEHAVIOUR.md`](../rules/ACTIVE_NO_MOVES_BEHAVIOUR.md) ANM‑SCEN‑01/02/03 catalogue.<br>[`docs/supplementary/RULES_CONSISTENCY_EDGE_CASES.md`](../supplementary/RULES_CONSISTENCY_EDGE_CASES.md) CCE‑001/002/007 notes on FE heuristics and ANM invariants.<br>[`RULES_RULESET_CLARIFICATIONS.md`](../supplementary/RULES_RULESET_CLARIFICATIONS.md) FE / ANM clarifications. | [`docs/ux/UX_RULES_WEIRD_STATES_SPEC.md`](UX_RULES_WEIRD_STATES_SPEC.md) RWS‑001/004 (`ANM_MOVEMENT_FE_BLOCKED`, `FE_SEQUENCE_CURRENT_PLAYER`).<br>[`docs/ux/UX_RULES_TEACHING_SCENARIOS.md`](UX_RULES_TEACHING_SCENARIOS.md) flow `fe_loop_intro` and ANM/FE teaching scenarios.<br>[`docs/ux/UX_RULES_COPY_SPEC.md`](UX_RULES_COPY_SPEC.md) FE/ANM HUD and help copy.<br>[`docs/ux/UX_RULES_IMPROVEMENT_LOOP.md`](UX_RULES_IMPROVEMENT_LOOP.md) W‑UX iteration focus on `anm_forced_elimination`.                            | Engine detection and semantics in [`src/shared/engine/turnLogic.ts`](../../src/shared/engine/turnLogic.ts) (forced elimination entry / ANM invariants).<br>Host integration in [`src/server/game/turn/TurnEngine.ts`](../../src/server/game/turn/TurnEngine.ts) and [`src/server/game/GameEngine.ts`](../../src/server/game/GameEngine.ts).<br>Weird‑state mapping and HUD usage in [`src/shared/engine/weirdStateReasons.ts`](../../src/shared/engine/weirdStateReasons.ts), [`src/client/components/GameHUD.tsx`](../../src/client/components/GameHUD.tsx), and [`src/client/components/VictoryModal.tsx`](../../src/client/components/VictoryModal.tsx).<br>Teaching entrypoints in [`src/client/components/TeachingOverlay.tsx`](../../src/client/components/TeachingOverlay.tsx) and sandbox FE helpers in [`src/client/sandbox/ClientSandboxEngine.ts`](../../src/client/sandbox/ClientSandboxEngine.ts). | Telemetry schema and `rules_context = 'anm_forced_elimination'` in [`docs/ux/UX_RULES_TELEMETRY_SPEC.md`](UX_RULES_TELEMETRY_SPEC.md).<br>Event payloads and enums in [`src/shared/telemetry/rulesUxEvents.ts`](../../src/shared/telemetry/rulesUxEvents.ts).<br>Hotspot analysis (`resign_after_weird_state` for FE) in [`docs/ux/UX_RULES_IMPROVEMENT_LOOP.md`](UX_RULES_IMPROVEMENT_LOOP.md).<br>ANM/FE invariants and parity tests in [`ai-service/tests/invariants/test_active_no_moves_movement_forced_elimination_regression.py`](../../ai-service/tests/invariants/test_active_no_moves_movement_forced_elimination_regression.py) and related ANM suites.                                                             |
| `structural_stalemate`       | Structural stalemate & tiebreak ladder              | Global plateau where **no legal placements, moves, captures, or forced eliminations exist for any player**, and the game ends by a ladder: territory → eliminated rings (including rings in hand) → markers → last actor. Often perceived as “game just ended” without a clear winner explanation.                                                                                                                                                                                                                                                                                                                                                           | [`RULES_CANONICAL_SPEC.md`](../../RULES_CANONICAL_SPEC.md) R173 (global stalemate and tiebreak ladder).<br>[`../rules/COMPLETE_RULES.md`](../rules/COMPLETE_RULES.md) §13.4 End of Game “Stalemate” Resolution.<br>[`docs/rules/ACTIVE_NO_MOVES_BEHAVIOUR.md`](../rules/ACTIVE_NO_MOVES_BEHAVIOUR.md) ANM‑SCEN‑06.<br>[`docs/supplementary/RULES_CONSISTENCY_EDGE_CASES.md`](../supplementary/RULES_CONSISTENCY_EDGE_CASES.md) CCE‑006 LPS vs stalemate compromise.<br>[`archive/FINAL_RULES_AUDIT_REPORT.md`](../../archive/FINAL_RULES_AUDIT_REPORT.md) stalemate / plateau audit outcomes.                                                                                                                                                                                                                           | [`docs/ux/UX_RULES_WEIRD_STATES_SPEC.md`](UX_RULES_WEIRD_STATES_SPEC.md) RWS‑005 `STRUCTURAL_STALEMATE_TIEBREAK` (HUD/VictoryModal copy + anchors).<br>[`docs/ux/UX_RULES_TEACHING_SCENARIOS.md`](UX_RULES_TEACHING_SCENARIOS.md) flow `structural_stalemate_intro` (ladder explanation).<br>[`docs/ux/UX_RULES_COPY_SPEC.md`](UX_RULES_COPY_SPEC.md) stalemate copy baselines.<br>[`docs/ux/UX_RULES_IMPROVEMENT_LOOP.md`](UX_RULES_IMPROVEMENT_LOOP.md) treating structural stalemate confusion as a first‑wave W‑UX target. | Termination and ladder logic in [`src/shared/engine/aggregates/VictoryAggregate.ts`](../../src/shared/engine/aggregates/VictoryAggregate.ts).<br>Result reasons and mapping in [`src/shared/engine/weirdStateReasons.ts`](../../src/shared/engine/weirdStateReasons.ts).<br>Game‑over explanation in [`src/client/components/VictoryModal.tsx`](../../src/client/components/VictoryModal.tsx) and HUD banners in [`src/client/components/GameHUD.tsx`](../../src/client/components/GameHUD.tsx).<br>Teaching routes via `victory_stalemate` topic in [`src/client/components/TeachingOverlay.tsx`](../../src/client/components/TeachingOverlay.tsx).                                                                                                                                                                                                                                                            | Telemetry `rules_context = 'structural_stalemate'` and `weird_state_type = 'structural-stalemate'` in [`docs/ux/UX_RULES_TELEMETRY_SPEC.md`](UX_RULES_TELEMETRY_SPEC.md) and [`docs/ux/UX_RULES_WEIRD_STATES_SPEC.md`](UX_RULES_WEIRD_STATES_SPEC.md).<br>Hotspot queries for resigns after stalemate in [`docs/ux/UX_RULES_TELEMETRY_SPEC.md`](UX_RULES_TELEMETRY_SPEC.md).<br>Scenario tests in [`tests/unit/GameEngine.victory.scenarios.test.ts`](../../tests/unit/GameEngine.victory.scenarios.test.ts) and Python stalemate invariants.                                                                                                                                                                                  |
| `territory_mini_regions`     | Territory mini‑regions & Q23‑style self‑elimination | Small disconnected regions (often 2×2 “mini‑regions”) where one player collapses territory, eliminates all interior rings, **and must also self‑eliminate** an outside ring/cap. This underlies FAQ Q23 and many “why did I lose my own ring?” questions.                                                                                                                                                                                                                                                                                                                                                                                                    | [`../rules/COMPLETE_RULES.md`](../rules/COMPLETE_RULES.md) FAQ Q23 (mini‑regions and self‑elimination).<br>[`RULES_CANONICAL_SPEC.md`](../../RULES_CANONICAL_SPEC.md) R141–R145 (disconnected regions and self‑elimination prerequisite).<br>[`docs/supplementary/RULES_CONSISTENCY_EDGE_CASES.md`](../supplementary/RULES_CONSISTENCY_EDGE_CASES.md) CCE‑005 territory self‑elimination clarifications.<br>[`archive/RULES_DYNAMIC_VERIFICATION.md`](../../archive/RULES_DYNAMIC_VERIFICATION.md) SCEN‑TERRITORY‑002 multi‑region budget examples.                                                                                                                                                                                                                                                                     | [`docs/ux/UX_RULES_TEACHING_SCENARIOS.md`](UX_RULES_TEACHING_SCENARIOS.md) flow `mini_region_intro` (Q23 archetype with interior + self‑elimination focus).<br>[`docs/ux/UX_RULES_WEIRD_STATES_SPEC.md`](UX_RULES_WEIRD_STATES_SPEC.md) RWS‑003 (`ANM_TERRITORY_NO_ACTIONS`) for auto‑exit cases after territory decisions.<br>[`docs/ux/UX_RULES_COPY_SPEC.md`](UX_RULES_COPY_SPEC.md) territory HUD language emphasising "entire stack cap outside each region".                                                             | Territory discovery and processing in [`src/shared/engine/territoryDetection.ts`](../../src/shared/engine/territoryDetection.ts), [`src/shared/engine/territoryProcessing.ts`](../../src/shared/engine/territoryProcessing.ts), and [`src/shared/engine/territoryDecisionHelpers.ts`](../../src/shared/engine/territoryDecisionHelpers.ts).<br>Sandbox helpers in [`src/client/sandbox/sandboxTerritory.ts`](../../src/client/sandbox/sandboxTerritory.ts) and teaching flows in [`src/shared/teaching/teachingScenarios.ts`](../../src/shared/teaching/teachingScenarios.ts).<br>HUD & overlays that surface mini‑region explanations (territory banners, “What happened?” links) in [`src/client/components/GameHUD.tsx`](../../src/client/components/GameHUD.tsx) and [`src/client/components/TeachingOverlay.tsx`](../../src/client/components/TeachingOverlay.tsx).                                        | Rules‑UX telemetry `rules_context = 'territory_mini_region'` and `territory_multi_region` in [`docs/ux/UX_RULES_TELEMETRY_SPEC.md`](UX_RULES_TELEMETRY_SPEC.md).<br>Scenario tests [`tests/scenarios/RulesMatrix.Territory.MiniRegion.test.ts`](../../tests/scenarios/RulesMatrix.Territory.MiniRegion.test.ts).<br>Helper tests [`tests/unit/territoryDecisionHelpers.shared.test.ts`](../../tests/unit/territoryDecisionHelpers.shared.test.ts) and multi‑phase contract vectors in `tests/fixtures/contract-vectors/v2/territory.vectors.json`.                                                                                                                                                                             |
| `capture_chains`             | Capture chains & ring‑forming captures              | Mandatory‑continuation capture sequences where a stack overtakes multiple caps in a single turn, often with 180° reversals or cycles. Highly visible, tactically deep, and historically prone to “false interface” copy suggesting captures can be ended early.                                                                                                                                                                                                                                                                                                                                                                                              | [`RULES_CANONICAL_SPEC.md`](../../RULES_CANONICAL_SPEC.md) R101–R103 (overtaking captures and chain behaviour).<br>[`../rules/COMPLETE_RULES.md`](../rules/COMPLETE_RULES.md) §10 Capture (Overtaking) Movement and §11 Line Formation & Collapse (interaction with chains).<br>[`docs/supplementary/RULES_CONSISTENCY_EDGE_CASES.md`](../supplementary/RULES_CONSISTENCY_EDGE_CASES.md) capture‑chain edge‑cases and cyclic patterns.<br>FAQ capture examples in [`../rules/COMPLETE_RULES.md`](../rules/COMPLETE_RULES.md) §15.3 Common Capture Patterns.                                                                                                                                                                                                                                                             | [`docs/ux/UX_RULES_TEACHING_SCENARIOS.md`](UX_RULES_TEACHING_SCENARIOS.md) flow `capture_chain_mandatory` (optional start, mandatory continuation, branch choice).<br>[`docs/ux/UX_RULES_WEIRD_STATES_SPEC.md`](UX_RULES_WEIRD_STATES_SPEC.md) routing from capture‑related weird states into teaching topics.<br>[`docs/ux/UX_RULES_COPY_SPEC.md`](UX_RULES_COPY_SPEC.md) corrected HUD copy removing “end your turn” language for chains.                                                                                    | Capture enumeration and legality in [`src/shared/engine/captureLogic.ts`](../../src/shared/engine/captureLogic.ts) and [`src/shared/engine/aggregates/CaptureAggregate.ts`](../../src/shared/engine/aggregates/CaptureAggregate.ts).<br>Server orchestration in [`src/server/game/GameEngine.ts`](../../src/server/game/GameEngine.ts) and [`src/server/game/RuleEngine.ts`](../../src/server/game/RuleEngine.ts).<br>Sandbox capture flows and visualisation in [`src/client/sandbox/ClientSandboxEngine.ts`](../../src/client/sandbox/ClientSandboxEngine.ts) and [`src/client/sandbox/sandboxCaptures.ts`](../../src/client/sandbox/sandboxCaptures.ts).<br>HUD phase copy / prompts in [`src/client/components/GameHUD.tsx`](../../src/client/components/GameHUD.tsx).                                                                                                                                      | `rules_context = 'capture_chain_mandatory'` in [`docs/ux/UX_RULES_TELEMETRY_SPEC.md`](UX_RULES_TELEMETRY_SPEC.md).<br>Shared capture tests [`tests/unit/captureLogic.shared.test.ts`](../../tests/unit/captureLogic.shared.test.ts) and chain scenarios in [`tests/unit/GameEngine.chainCapture.test.ts`](../../tests/unit/GameEngine.chainCapture.test.ts).<br>Contract vectors for capture‑heavy positions in `tests/fixtures/contract-vectors/v2/forced_elimination.vectors.json` and `multi_phase_turn.vectors.json`.                                                                                                                                                                                                      |
| `lps_real_actions`           | Last Player Standing & "only real moves" semantics  | Cases where, over three consecutive full rounds, **exactly one player has real actions** (placements, non‑capture moves, captures) while all other players with material have only forced eliminations or no actions, yielding a Last Player Standing victory.                                                                                                                                                                                                                                                                                                                                                                                               | [`RULES_CANONICAL_SPEC.md`](../../RULES_CANONICAL_SPEC.md) R172 Last Player Standing.<br>[`../rules/COMPLETE_RULES.md`](../rules/COMPLETE_RULES.md) §13.3 Last Player Standing (real actions, temporary inactivity, and three‑round condition).<br>[`docs/rules/ACTIVE_NO_MOVES_BEHAVIOUR.md`](../rules/ACTIVE_NO_MOVES_BEHAVIOUR.md) ANM‑SCEN‑07.                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | [`docs/ux/UX_RULES_WEIRD_STATES_SPEC.md`](UX_RULES_WEIRD_STATES_SPEC.md) RWS‑006 `LAST_PLAYER_STANDING_EXCLUSIVE_REAL_ACTIONS` (HUD & VictoryModal copy).<br>[`docs/ux/UX_RULES_TEACHING_SCENARIOS.md`](UX_RULES_TEACHING_SCENARIOS.md) flow `last_player_standing_intro` (real vs forced actions and early‑win semantics).<br>[`docs/ux/UX_RULES_COPY_SPEC.md`](UX_RULES_COPY_SPEC.md) victory copy variants for LPS vs stalemate.                                                                                            | Early LPS victory evaluation via shared helpers in [`src/shared/engine/lpsTracking.ts`](../../src/shared/engine/lpsTracking.ts) (round tracking and `evaluateLpsVictory`) and `VictoryAggregate.evaluateVictory`.<br>Weird‑state routing and reason codes in [`src/shared/engine/weirdStateReasons.ts`](../../src/shared/engine/weirdStateReasons.ts).<br>HUD / VictoryModal messaging in [`src/client/components/GameHUD.tsx`](../../src/client/components/GameHUD.tsx) and [`src/client/components/VictoryModal.tsx`](../../src/client/components/VictoryModal.tsx).                                                                                                                                                                                                                                                                                                                                          | Telemetry `rules_context = 'last_player_standing'` in [`docs/ux/UX_RULES_TELEMETRY_SPEC.md`](UX_RULES_TELEMETRY_SPEC.md) and weird‑state mapping in [`docs/ux/UX_RULES_WEIRD_STATES_SPEC.md`](UX_RULES_WEIRD_STATES_SPEC.md).<br>Invariants and regression tests in `ai-service/tests/invariants/test_anm_and_termination_invariants.py` and LPS‑focused scenarios planned under `Victory.LastPlayerStanding.*`.                                                                                                                                                                                                                                                                                                               |
| `recovery_action`            | Recovery Action (temporarily eliminated players)    | Allows a recovery‑eligible player (controls no stacks, has markers, and has buried rings; eligibility is independent of rings in hand) to act during `movement` by sliding a marker to either (a) complete a line of **at least** `lineLength` (then collapse markers and pay via buried ring extraction) or (b) if no line‑forming slide exists, perform a fallback‑class recovery: either an adjacent empty‑cell repositioning slide **or** a stack‑strike onto an adjacent stack (sacrificing the marker to eliminate the stack’s top ring), both paid via buried ring extraction. Recovery is a legal action but **not** a real action for LPS purposes. | [`RULES_CANONICAL_SPEC.md`](../../RULES_CANONICAL_SPEC.md) R110–R115 (recovery eligibility, marker slide, line requirement, buried ring extraction, cascade processing, recording semantics).<br>[`../rules/COMPLETE_RULES.md`](../rules/COMPLETE_RULES.md) §4.5 Recovery Action.<br>[`../rules/COMPACT_RULES.md`](../rules/COMPACT_RULES.md) §2.4 Recovery action.<br>[`docs/rules/ACTIVE_NO_MOVES_BEHAVIOUR.md`](../rules/ACTIVE_NO_MOVES_BEHAVIOUR.md) ANM‑SCEN‑09 (temporarily eliminated with recovery).                                                                                                                                                                                                                                                                                                           | UX gaps and teaching plan in [`docs/ux/UX_RULES_TEACHING_GAP_ANALYSIS.md`](UX_RULES_TEACHING_GAP_ANALYSIS.md) (`recovery_action`, GAP‑RECOV‑01…04).<br>Recovery cost exception is referenced in territory copy in [`docs/ux/UX_RULES_COPY_SPEC.md`](UX_RULES_COPY_SPEC.md).                                                                                                                                                                                                                                                    | Implemented: TS [`src/shared/engine/aggregates/RecoveryAggregate.ts`](../../src/shared/engine/aggregates/RecoveryAggregate.ts) and integration in [`src/shared/engine/orchestration/turnOrchestrator.ts`](../../src/shared/engine/orchestration/turnOrchestrator.ts).<br>Python: [`ai-service/app/rules/recovery.py`](../../ai-service/app/rules/recovery.py) and [`ai-service/app/game_engine/__init__.py`](../../ai-service/app/game_engine/__init__.py).                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Contract vectors `tests/fixtures/contract-vectors/v2/recovery_action.vectors.json` plus TS unit tests in `tests/unit/RecoveryAggregate.shared.test.ts` and Python unit/parity tests in `ai-service/tests/rules/test_recovery.py` and `ai-service/tests/parity/test_recovery_parity.py`.                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| `line_vs_territory_ordering` | Line vs territory processing / ordering             | Multi‑phase turns where a single move creates both **eligible lines and disconnected regions**. Correct resolution requires deterministic ordering (movement → capture chain → lines → territory → victory) and sometimes tricky choices about line‑reward options before territory.                                                                                                                                                                                                                                                                                                                                                                         | [`RULES_CANONICAL_SPEC.md`](../../RULES_CANONICAL_SPEC.md) R120–R122 (lines) and [`RULES_CANONICAL_SPEC.md`](../../RULES_CANONICAL_SPEC.md) R144–R145 (territory processing), plus [`RULES_CANONICAL_SPEC.md`](../../RULES_CANONICAL_SPEC.md) R204 (phase exits and ANM).<br>[`../rules/COMPLETE_RULES.md`](../rules/COMPLETE_RULES.md) §4.5 Post‑Movement Processing, §11 Line Formation & Collapse, and §12 Area Disconnection & Collapse.<br>[`archive/RULES_DYNAMIC_VERIFICATION.md`](../../archive/RULES_DYNAMIC_VERIFICATION.md) SCEN‑TERRITORY‑003 combined line+territory scenarios.                                                                                                                                                                                                                            | [`docs/ux/UX_RULES_TEACHING_SCENARIOS.md`](UX_RULES_TEACHING_SCENARIOS.md) flow `line_vs_territory_blocking` (multi‑phase examples and option‑1 vs option‑2 impacts).<br>[`docs/ux/UX_RULES_WEIRD_STATES_SPEC.md`](UX_RULES_WEIRD_STATES_SPEC.md) ANM exit codes for line and territory phases.<br>[`docs/ux/UX_RULES_COPY_SPEC.md`](UX_RULES_COPY_SPEC.md) HUD copy for line processing and territory phases.                                                                                                                 | Shared helpers [`src/shared/engine/lineDetection.ts`](../../src/shared/engine/lineDetection.ts), [`src/shared/engine/lineDecisionHelpers.ts`](../../src/shared/engine/lineDecisionHelpers.ts), [`src/shared/engine/territoryDetection.ts`](../../src/shared/engine/territoryDetection.ts), and [`src/shared/engine/territoryDecisionHelpers.ts`](../../src/shared/engine/territoryDecisionHelpers.ts).<br>Turn/phase orchestration in [`src/shared/engine/turnLogic.ts`](../../src/shared/engine/turnLogic.ts) and backend host in [`src/server/game/GameEngine.ts`](../../src/server/game/GameEngine.ts).<br>Sandbox integration in [`src/client/sandbox/ClientSandboxEngine.ts`](../../src/client/sandbox/ClientSandboxEngine.ts).                                                                                                                                                                            | `rules_context = 'line_reward_exact'` / `'line_reward_overlength'` and `territory_mini_region` / `territory_multi_region` in [`docs/ux/UX_RULES_TELEMETRY_SPEC.md`](UX_RULES_TELEMETRY_SPEC.md).<br>Line and territory helper tests in [`tests/unit/lineDecisionHelpers.shared.test.ts`](../../tests/unit/lineDecisionHelpers.shared.test.ts) and [`tests/unit/territoryDecisionHelpers.shared.test.ts`](../../tests/unit/territoryDecisionHelpers.shared.test.ts).<br>Multi‑phase orchestration tests in [`tests/scenarios/MultiPhaseTurn.contractVectors.test.ts`](../../tests/scenarios/MultiPhaseTurn.contractVectors.test.ts) and contract vectors in `tests/fixtures/contract-vectors/v2/multi_phase_turn.vectors.json`. |

### 2.2 How to use this index

For each concept row:

- Treat the **Canonical rules docs** column as the starting point when semantics are in doubt.
- Use **UX & teaching docs** to align HUD, VictoryModal, TeachingOverlay, and sandbox flows with those semantics.
- Consult **Engine / UX implementation touchpoints** before proposing behaviour changes, to understand where the concept is wired into hosts.
- Use **Telemetry / tests** links to:
  - Identify where confusion is measured today (`rules_context`, `rulesConcept`).
  - Find focused tests and contract vectors to extend when behaviour or UX changes.

## 3. Usage & maintenance

- When new **tricky rules behaviours** are formalised (e.g. new weird‑state reason codes, additional territory archetypes, advanced AI‑driven rules surfaces), add a new row to this table with:
  - A stable **concept id** (prefer matching `rules_context` / `rulesConcept` where possible).
  - Pointers into canonical rules docs, UX specs, implementation touchpoints, and telemetry/tests.
- When planning rules‑UX work (W‑UX‑1…W‑UX‑N), treat this file as the **first stop** for “where is X explained / implemented / telemetried?”. Update it as part of any change that adds or deprecates a high‑risk concept.
- Future iteration docs such as [`docs/ux/rules_iterations/UX_RULES_IMPROVEMENT_ITERATION_0002.md`](rules_iterations/UX_RULES_IMPROVEMENT_ITERATION_0002.md) and later should reference concept ids from this table when declaring their focus (e.g. `concept = territory_mini_regions`, `concept = anm_fe_core`), so telemetry and tests can be filtered consistently.
- If canonical rules semantics move (e.g. RR‑CANON is refactored or the public rulebook changes structure), prefer updating the **anchors in this index** rather than duplicating long explanations elsewhere.
