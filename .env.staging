# Staging environment template for RingRift
#
# Usage:
#   cp .env.staging .env
# then run docker-compose with docker-compose.staging.yml overlay.

# ---------------------------------------------------------------------------
# Core server
# ---------------------------------------------------------------------------
NODE_ENV=production
PORT=3000
SOCKET_PORT=3001

# ---------------------------------------------------------------------------
# Database (PostgreSQL + Prisma)
# ---------------------------------------------------------------------------
# Host connection string used by Prisma when running commands on the host.
# When running inside Docker Compose, the app container will use the
# DATABASE_URL defined in docker-compose.yml with host "postgres".
DATABASE_URL=postgresql://ringrift:staging-db-password@localhost:5432/ringrift
DB_HOST=localhost
DB_PORT=5432
DB_NAME=ringrift
DB_USER=ringrift
DB_PASSWORD=staging-db-password

# ---------------------------------------------------------------------------
# Redis
# ---------------------------------------------------------------------------
REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=staging-redis-password

# ---------------------------------------------------------------------------
# JWT / Auth
# ---------------------------------------------------------------------------
# These secrets are acceptable for local staging but MUST be rotated for any
# real external deployment. The backend will refuse to start in production
# if you use known placeholder values from .env.example or docker-compose.yml.
JWT_SECRET=dev-staging-access-token-secret
JWT_REFRESH_SECRET=dev-staging-refresh-token-secret
JWT_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# ---------------------------------------------------------------------------
# CORS / client
# ---------------------------------------------------------------------------
# When running the full staging stack via Docker Compose, the React client
# is served by the Node backend on http://localhost:3000.
CORS_ORIGIN=http://localhost:3000
ALLOWED_ORIGINS=http://localhost:3000

# ---------------------------------------------------------------------------
# File storage & logging
# ---------------------------------------------------------------------------
UPLOAD_DIR=./uploads
MAX_FILE_SIZE=5242880
LOG_LEVEL=info
LOG_FILE=./logs/app.log

# ---------------------------------------------------------------------------
# AI service
# ---------------------------------------------------------------------------
# For local dev, the AI service usually runs at http://localhost:8001.
# Inside Docker Compose, the backend talks to http://ai-service:8001 via the
# AI_SERVICE_URL configured in docker-compose.yml.
AI_SERVICE_URL=http://localhost:8001
AI_SERVICE_PORT=8001
AI_LOG_LEVEL=INFO

# ---------------------------------------------------------------------------
# Rules engine & topology
# ---------------------------------------------------------------------------
# Rules engine authority mode for backend â†” Python integration.
# Options: ts | python | shadow
RINGRIFT_RULES_MODE=shadow

# Backend deployment topology; staging uses a single authoritative instance.
RINGRIFT_APP_TOPOLOGY=single