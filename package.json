{
  "name": "ringrift",
  "version": "0.1.0-beta",
  "description": "Web-based multiplayer RingRift game",
  "main": "dist/server/index.js",
  "scripts": {
    "dev": "concurrently \"npm run dev:server\" \"npm run dev:client\"",
    "dev:server": "TS_NODE_PROJECT=tsconfig.server.json nodemon --exec ts-node src/server/index.ts",
    "dev:client": "vite",
    "dev:sandbox:diagnostics": "bash scripts/dev-sandbox-diagnostics.sh",
    "dev:free-port": "kill-port 3000",
    "dev:free-all": "kill-port 3000 3001 5173",
    "dev:app": "npm run dev:free-port && npm run dev",
    "soak:orchestrator": "npx ts-node scripts/run-orchestrator-soak.ts",
    "soak:orchestrator:smoke": "TS_NODE_PROJECT=tsconfig.server.json npx ts-node scripts/run-orchestrator-soak.ts --boardTypes=square8 --gamesPerBoard=1 --maxTurns=20 --mode=backend --outputPath=results/orchestrator_soak_smoke.json --failOnViolation",
    "soak:orchestrator:short": "TS_NODE_PROJECT=tsconfig.server.json npx ts-node scripts/run-orchestrator-soak.ts --profile=ci-short --failOnViolation=true",
    "soak:orchestrator:deep": "TS_NODE_PROJECT=tsconfig.server.json npx ts-node scripts/run-orchestrator-soak.ts --profile=local-deep --failOnViolation=true",
    "soak:orchestrator:nightly": "TS_NODE_PROJECT=tsconfig.server.json npx ts-node scripts/run-orchestrator-soak.ts --profile=local-deep --outputPath=results/orchestrator_soak_nightly.json --failOnViolation",
    "load:orchestrator:smoke": "TS_NODE_PROJECT=tsconfig.server.json npx ts-node scripts/orchestrator-load-smoke.ts",
    "load:websocket:gameplay:smoke": "BASE_URL=${BASE_URL:-http://localhost:3000} WS_URL=${WS_URL:-ws://localhost:3000} npx k6 run tests/load/scenarios/websocket-gameplay.js",
    "load:websocket:gameplay:throughput": "ENABLE_WS_GAMEPLAY_THROUGHPUT=true BASE_URL=${BASE_URL:-http://localhost:3000} WS_URL=${WS_URL:-ws://localhost:3000} npx k6 run tests/load/scenarios/websocket-gameplay.js",
    "load:baseline": "BASE_URL=${BASE_URL:-http://localhost:3001} k6 run tests/load/scenarios/game-creation.js",
    "load:baseline:local": "cd tests/load && chmod +x scripts/run-baseline.sh && ./scripts/run-baseline.sh local",
    "load:baseline:staging": "cd tests/load && chmod +x scripts/run-baseline.sh && ./scripts/run-baseline.sh staging",
    "load-test:baseline": "THRESHOLD_ENV=${THRESHOLD_ENV:-staging} RINGRIFT_ENV=${RINGRIFT_ENV:-staging} BASE_URL=${BASE_URL:-http://localhost:3000} WS_URL=${WS_URL:-ws://localhost:3000} WS_GAMEPLAY_MODE=${WS_GAMEPLAY_MODE:-baseline} npx k6 run tests/load/scenarios/websocket-gameplay.js",
    "load:analyze": "node tests/load/scripts/analyze-results.js",
    "load:analyze:target": "node tests/load/scripts/analyze-target-scale.js",
    "load:seed-users": "DATABASE_URL=${DATABASE_URL:-postgresql://ringrift:password@localhost:5432/ringrift} node scripts/seed-loadtest-users.js",
    "load:target:local": "cd tests/load && chmod +x scripts/run-target-scale.sh && ./scripts/run-target-scale.sh local",
    "load:target:staging": "cd tests/load && chmod +x scripts/run-target-scale.sh && ./scripts/run-target-scale.sh staging",
    "load:target:short:local": "cd tests/load && chmod +x scripts/run-target-scale-short.sh && ./scripts/run-target-scale-short.sh local",
    "load:target:short:staging": "cd tests/load && chmod +x scripts/run-target-scale-short.sh && ./scripts/run-target-scale-short.sh staging",
    "load:ai-heavy:local": "cd tests/load && chmod +x scripts/run-ai-heavy.sh && ./scripts/run-ai-heavy.sh local",
    "load:ai-heavy:staging": "cd tests/load && chmod +x scripts/run-ai-heavy.sh && ./scripts/run-ai-heavy.sh staging",
    "load:stress": "BASE_URL=${BASE_URL:-http://localhost:3001} LOAD_PROFILE=stress k6 run --config tests/load/k6.config.js tests/load/scenarios/concurrent-games.js",
    "load:stress:breaking": "cd tests/load && chmod +x scripts/run-stress-test.sh && ./scripts/run-stress-test.sh staging",
    "load:game-creation": "BASE_URL=${BASE_URL:-http://localhost:3001} k6 run tests/load/scenarios/game-creation.js",
    "load:concurrent-games": "BASE_URL=${BASE_URL:-http://localhost:3001} k6 run tests/load/scenarios/concurrent-games.js",
    "load:player-moves": "BASE_URL=${BASE_URL:-http://localhost:3001} k6 run tests/load/scenarios/player-moves.js",
    "load:websocket": "BASE_URL=${BASE_URL:-http://localhost:3001} WS_URL=${WS_URL:-ws://localhost:3001} k6 run tests/load/scenarios/websocket-stress.js",
    "load:all": "npm run load:game-creation && npm run load:concurrent-games && npm run load:player-moves && npm run load:websocket",
    "load:smoke:all": "cd tests/load && npm run test:smoke:game-creation && npm run test:smoke:concurrent-games && npm run test:smoke:player-moves && npm run test:smoke:websocket-stress",
    "load:validate": "cd tests/load && npm run validate:syntax",
    "load:preflight": "node tests/load/scripts/preflight-check.js",
    "load:preflight:verbose": "node tests/load/scripts/preflight-check.js --verbose",
    "load:preflight:skip-ai": "node tests/load/scripts/preflight-check.js --skip-ai",
    "slo:verify": "node tests/load/scripts/verify-slos.js",
    "slo:dashboard": "node tests/load/scripts/generate-slo-dashboard.js",
    "slo:check": "cd tests/load && chmod +x scripts/run-slo-verification.sh && ./scripts/run-slo-verification.sh staging",
    "slo:check:local": "cd tests/load && chmod +x scripts/run-slo-verification.sh && ./scripts/run-slo-verification.sh local",
    "slo:check:production": "cd tests/load && chmod +x scripts/run-slo-verification.sh && ./scripts/run-slo-verification.sh staging --env production",
    "slo:gate": "TS_NODE_PROJECT=tsconfig.server.json npx ts-node scripts/slo-gate-check.ts",
    "slo:gate:staging": "TS_NODE_PROJECT=tsconfig.server.json npx ts-node scripts/slo-gate-check.ts --env staging",
    "slo:gate:production": "TS_NODE_PROJECT=tsconfig.server.json npx ts-node scripts/slo-gate-check.ts --env production --fail-on-breach",
    "smoke:orchestrator:preflight": "npm run soak:orchestrator:smoke && npm run load:orchestrator:smoke && npm run test:e2e -- tests/e2e/metrics.e2e.spec.ts",
    "build": "npm run build:server && npm run build:client",
    "build:server": "tsc -p tsconfig.server.json",
    "build:client": "vite build",
    "start": "node dist/server/index.js",
    "test": "jest --forceExit --workerIdleMemoryLimit=512MB",
    "test:fast": "jest --forceExit --testPathPattern='(components/|\\.shared\\.test\\.ts$|Aggregate\\.(core|shared)\\.)'  --testPathIgnorePatterns='/node_modules/' '/dist/' '<rootDir>/tests/e2e/'",
    "test:medium": "jest --forceExit --workerIdleMemoryLimit=512MB --testPathPattern='tests/unit' --testPathIgnorePatterns='/node_modules/' '/dist/' '<rootDir>/tests/e2e/' '<rootDir>/tests/unit/archive/' 'aiSimulation' 'aiHeuristicCoverage' '\\.MoveDriven\\.' 'Parity\\.' 'movementCapture\\.test' 'RulesMatrix\\.' 'FAQ_Q' 'territoryDisconnection\\.hex' 'territory\\.scenarios' 'LineAndTerritory'",
    "test:safe": "timeout 30m jest --forceExit --workerIdleMemoryLimit=512MB || echo 'Tests timed out or failed'",
    "test:watch": "jest --watch",
    "test:coverage": "timeout 45m jest --coverage --forceExit --workerIdleMemoryLimit=512MB",
    "test:debug-hangs": "jest --detectOpenHandles --forceExit --runInBand --verbose",
    "test:coverage:watch": "jest --coverage --watch",
    "test:coverage:shared-engine": "jest --coverage --collectCoverageFrom=src/shared/engine/*.ts --testPathPattern='unit'",
    "test:coverage:server": "jest --coverage --testPathPattern='(tests/integration/|tests/unit/middleware/)'",
    "test:coverage:components": "jest --forceExit --workerIdleMemoryLimit=512MB --coverage --testPathPattern=tests/unit/components --coverageThreshold '{\"global\":{\"branches\":0,\"functions\":0,\"lines\":0,\"statements\":0}}'",
    "test:core": "jest --runInBand --workerIdleMemoryLimit=512MB --testPathIgnorePatterns='/node_modules/' '/dist/' '/build/' '<rootDir>/tests/e2e/' '<rootDir>/tests/parity/' '\\.e2e\\.spec\\.ts$' 'LobbyRealtime\\.test\\.ts$' 'WebSocketServer\\..+\\.integration\\.test\\.ts$' 'GameEngine\\.aiSimulation\\.test\\.ts$' 'GameContext\\.reconnect\\.test\\.tsx$' 'aiHeuristicCoverage\\.test\\.ts$' 'api\\.client\\.test\\.ts$' 'envFlags\\.test\\.ts$' 'Parity\\..*\\.test\\.ts$' 'ParityDebug' 'bisectParity\\.test\\.ts$' 'Sandbox_vs_Backend' 'Backend_vs_Sandbox' '\\.parity\\.test\\.ts$' '\\.traceDebug\\.test\\.ts$' '\\.seed\\d+' '\\.debug\\.' 'NoRandomInCoreRules\\.test\\.ts$' 'GameEngine\\.territoryDisconnection\\.hex\\.test\\.ts$' 'GameEngine\\.regionOrderChoiceIntegration\\.test\\.ts$' 'FAQ_Q\\d+.*\\.test\\.ts$' 'GameEngine\\.territory\\.scenarios\\.test\\.ts$' 'ClientSandboxEngine\\.territoryDecisionPhases\\.MoveDriven\\.test\\.ts$' 'RulesMatrix\\.Elimination\\.ClientSandboxEngine\\.test\\.ts$' 'RulesMatrix\\.Comprehensive\\.test\\.ts$' 'RulesMatrix\\.Territory\\.GameEngine\\.test\\.ts$' 'territoryProcessing\\.rules\\.test\\.ts$' 'LineAndTerritory\\.test\\.ts$'",
    "test:diagnostics": "jest --passWithNoTests --testPathPattern='(ClientSandboxEngine\\.territoryDecisionPhases\\.MoveDriven|MovementCaptureParity\\.RuleEngine_vs_Sandbox|GameSession\\.setup\\.branchCoverage)\\.test\\.ts$'",
    "test:diagnostic": "jest --passWithNoTests --forceExit --workerIdleMemoryLimit=512MB --testPathPattern='tests/parity/' --testPathIgnorePatterns='/node_modules/' '/dist/'",
    "test:parity": "jest --passWithNoTests --forceExit --workerIdleMemoryLimit=512MB --testPathPattern='tests/parity/' --testPathIgnorePatterns='/node_modules/' '/dist/'",
    "test:ci": "jest --ci --coverage --maxWorkers=2 --testPathIgnorePatterns='/node_modules/' '/dist/' '/build/' '<rootDir>/tests/e2e/' '<rootDir>/tests/unit/archive/' 'ClientSandboxEngine\\.territoryDecisionPhases\\.MoveDriven\\.test\\.ts$' 'MovementCaptureParity\\.RuleEngine_vs_Sandbox\\.test\\.ts$' 'Sandbox_vs_Backend\\.aiHeuristicCoverage\\.test\\.ts$' 'GameSession\\.setup\\.branchCoverage\\.test\\.ts$'",
    "test:unit": "jest --testPathPattern=tests/unit",
    "test:integration": "jest --testPathPattern=tests/integration",
    "test:verbose": "jest --verbose",
    "test:quiet": "jest --runInBand --silent",
    "test:all:quiet:log": "mkdir -p logs/jest && jest --runInBand --silent > logs/jest/latest.log 2>&1",
    "test:python:quiet:log": "cd ai-service && mkdir -p ../logs/pytest && pytest -q > ../logs/pytest/ai-service.latest.log 2>&1",
    "gate:canonical-phases": "cd ai-service && PYTHONPATH=. python -m scripts.scan_canonical_phase_dbs --root data/games --pattern \"*.db\" --model-registry models/registry.json",
    "curate:golden": "TS_NODE_PROJECT=tsconfig.server.json npx ts-node scripts/curate-golden-fixtures.ts",
    "generate:golden": "TS_NODE_PROJECT=tsconfig.server.json npx ts-node scripts/generate-golden-fixtures.ts",
    "logs:view:jest": "node scripts/safe-view.js logs/jest/latest.log logs/jest/latest.view.txt",
    "logs:view:pytest": "node scripts/safe-view.js logs/pytest/ai-service.latest.log logs/pytest/ai-service.latest.view.txt",
    "test:ts-rules-engine": "jest --runInBand --testPathPattern='(RefactoredEngine|\\.rules\\.|RulesMatrix\\.)'",
    "test:ts-parity": "jest --runInBand --testPathPattern='(Parity\\.|traceParity|Python_vs_TS\\.traceParity)'",
    "test:export-line-territory": "RINGRIFT_EXPORT_PARITY_SNAPSHOTS=1 jest --runInBand tests/unit/ExportLineAndTerritorySnapshot.test.ts",
    "test:export-line-territory-multi-region": "RINGRIFT_EXPORT_PARITY_SNAPSHOTS=1 jest --runInBand tests/unit/ExportLineAndTerritoryMultiRegionSnapshot.test.ts",
    "test:ts-integration": "jest --runInBand --testPathPattern='(tests/integration|WebSocketServer\\.|FullGameFlow\\.test)'",
    "test:p0-robustness": "npm run test:ts-rules-engine && npm run test:ts-integration && jest --runInBand tests/contracts/contractVectorRunner.test.ts tests/parity/Backend_vs_Sandbox.CaptureAndTerritoryParity.test.ts tests/unit/WebSocketServer.sessionTermination.test.ts",
    "test:orchestrator-parity": "ORCHESTRATOR_ADAPTER_ENABLED=true ORCHESTRATOR_ROLLOUT_PERCENTAGE=100 RINGRIFT_RULES_MODE=ts jest --runInBand --testPathPattern='(\\\\.shared\\.test\\.ts$|tests/contracts/contractVectorRunner\\.test\\.ts$|RulesMatrix\\.|FAQ_Q.*\\.test\\.ts$|GameEngine\\.territoryDisconnection\\.test\\.ts$|ClientSandboxEngine\\.territoryDisconnection\\.test\\.ts$)'",
    "test:orchestrator-parity:ts": "jest --runInBand --testPathPattern='(tests/scenarios/Orchestrator\\.(Backend|Sandbox)\\.multiPhase\\.test\\.ts$|tests/unit/GameEngine\\.lines\\.scenarios\\.test\\.ts$|tests/unit/ClientSandboxEngine\\.lines\\.test\\.ts$|tests/unit/territoryDecisionHelpers\\.shared\\.test\\.ts$|tests/unit/GameEngine\\.territoryDisconnection\\.test\\.ts$|tests/unit/ClientSandboxEngine\\.territoryDisconnection\\.hex\\.test\\.ts$|tests/unit/CaptureAggregate\\.chainCapture\\.shared\\.test\\.ts$|tests/scenarios/ComplexChainCaptures\\.test\\.ts$|tests/scenarios/RulesMatrix\\.ChainCapture\\.ClientSandboxEngine\\.test\\.ts$|tests/unit/GameEngine\\.chainCapture\\.test\\.ts$|tests/unit/ClientSandboxEngine\\.chainCapture\\.test\\.ts$|tests/unit/ClientSandboxEngine\\.chainCapture\\.scenarios\\.test\\.ts$)'",
    "test:orchestrator:s-invariant": "RINGRIFT_TRACE_DEBUG=1 jest --runInBand tests/unit/OrchestratorSInvariant.regression.test.ts",
    "test:e2e": "playwright test",
    "test:e2e:smoke": "playwright test auth.e2e.spec.ts helpers.smoke.e2e.spec.ts sandbox.e2e.spec.ts",
    "test:e2e:chromium": "playwright test --project=chromium",
    "test:e2e:firefox": "playwright test --project=firefox",
    "test:e2e:webkit": "playwright test --project=webkit",
    "test:e2e:mobile": "playwright test --project='Mobile Chrome' --project='Mobile Safari'",
    "test:e2e:all": "playwright test --project=chromium --project=firefox --project=webkit",
    "test:e2e:full": "playwright test",
    "test:e2e:ui": "playwright test --ui",
    "test:e2e:headed": "playwright test --headed",
    "test:e2e:report": "playwright show-report",
    "test:e2e:debug": "playwright test --debug",
    "test:e2e:visual": "playwright test visual-regression",
    "test:e2e:visual:update": "playwright test visual-regression --update-snapshots",
    "test:ai-backend:quiet": "jest --runInBand --silent tests/unit/GameEngine.aiSimulation.test.ts",
    "test:ai-sandbox:quiet": "jest --runInBand --silent tests/unit/ClientSandboxEngine.aiSimulation.test.ts",
    "test:ai-movement:quiet": "jest --runInBand --silent tests/unit/ClientSandboxEngine.aiMovementCaptures.test.ts",
    "test:kill-jest": "pkill -f 'node_modules/.bin/jest' || true && pkill -f 'jest-worker/build/workers/processChild.js' || true",
    "lint": "eslint src --ext .ts,.tsx",
    "lint:fix": "eslint src --ext .ts,.tsx --fix",
    "docker:build": "docker build -t ringrift .",
    "docker:run": "docker-compose up",
    "dev:db": "bash scripts/dev-db.sh",
    "db:migrate": "npx prisma migrate dev",
    "db:generate": "npx prisma generate",
    "db:seed": "ts-node src/server/database/seed.ts",
    "prepare": "husky install",
    "validate:deployment": "npx ts-node scripts/validate-deployment-config.ts",
    "validate:monitoring": "scripts/validate-monitoring-configs.sh",
    "ssot-check": "npx ts-node scripts/ssot/ssot-check.ts",
    "check:parity-metrics": "TS_NODE_PROJECT=tsconfig.server.json npx ts-node scripts/check-parity-metrics.ts",
    "orchestrator:gating": "TS_NODE_PROJECT=tsconfig.server.json npx ts-node scripts/run-orchestrator-gating.ts",
    "dev:doctor": "TS_NODE_PROJECT=tsconfig.server.json npx ts-node scripts/dev_doctor.ts"
  },
  "keywords": [
    "game",
    "multiplayer",
    "strategy",
    "websocket",
    "typescript"
  ],
  "author": "RingRift Team",
  "license": "MIT",
  "engines": {
    "node": ">=18.0.0",
    "npm": ">=9.0.0"
  },
  "dependencies": {
    "@aws-sdk/client-ses": "^3.999.0",
    "@prisma/adapter-pg": "^7.4.2",
    "@prisma/client": "^7.4.2",
    "@sentry/node": "^10.40.0",
    "@sentry/react": "^10.40.0",
    "@tanstack/react-query": "^5.90.21",
    "@tanstack/react-query-devtools": "^5.91.3",
    "@types/morgan": "^1.9.10",
    "axios": "^1.13.5",
    "bcryptjs": "^3.0.3",
    "better-sqlite3": "^12.6.2",
    "clsx": "^2.0.0",
    "compression": "^1.7.4",
    "cors": "^2.8.6",
    "dotenv": "^17.3.1",
    "express": "^5.1.0",
    "helmet": "^8.1.0",
    "jsonwebtoken": "^9.0.3",
    "morgan": "^1.10.0",
    "pg": "^8.19.0",
    "prom-client": "^15.1.3",
    "rate-limiter-flexible": "^9.1.1",
    "react": "^19.2.4",
    "react-dom": "^19.2.4",
    "react-hot-toast": "^2.4.1",
    "react-router-dom": "^7.13.1",
    "redis": "^5.11.0",
    "socket.io": "^4.8.3",
    "socket.io-client": "^4.8.3",
    "swagger-jsdoc": "^6.2.8",
    "swagger-ui-express": "^5.0.1",
    "uuid": "^13.0.0",
    "winston": "^3.19.0",
    "zod": "^4.3.6"
  },
  "devDependencies": {
    "@babel/core": "^7.29.0",
    "@babel/plugin-syntax-import-meta": "^7.10.4",
    "@playwright/test": "^1.58.2",
    "@tailwindcss/postcss": "^4.2.1",
    "@testing-library/jest-dom": "^6.9.1",
    "@testing-library/react": "^16.3.2",
    "@testing-library/user-event": "^14.6.1",
    "@types/bcryptjs": "^2.4.6",
    "@types/better-sqlite3": "^7.6.13",
    "@types/compression": "^1.7.5",
    "@types/cors": "^2.8.17",
    "@types/express": "^5.0.5",
    "@types/jest": "^29.5.14",
    "@types/jsonwebtoken": "^9.0.5",
    "@types/node": "^25.0.3",
    "@types/pg": "^8.16.0",
    "@types/react": "^19.2.14",
    "@types/react-dom": "^19.2.3",
    "@types/supertest": "^7.2.0",
    "@types/swagger-jsdoc": "^6.0.4",
    "@types/swagger-ui-express": "^4.1.8",
    "@types/uuid": "^11.0.0",
    "@typescript-eslint/eslint-plugin": "^8.56.1",
    "@typescript-eslint/parser": "^8.48.0",
    "@vitejs/plugin-react": "^5.1.4",
    "autoprefixer": "^10.4.27",
    "babel-plugin-transform-import-meta": "^2.3.3",
    "concurrently": "^9.2.1",
    "eslint": "^9.39.2",
    "eslint-plugin-jest": "^29.11.1",
    "eslint-plugin-react": "^7.37.5",
    "eslint-plugin-react-hooks": "^7.0.1",
    "eslint-plugin-unicorn": "^62.0.0",
    "husky": "^9.1.7",
    "identity-obj-proxy": "^3.0.0",
    "jest": "^29.7.0",
    "jest-environment-jsdom": "^29.7.0",
    "kill-port": "^2.0.1",
    "lint-staged": "^16.2.6",
    "nodemon": "^3.1.14",
    "postcss": "^8.5.6",
    "prettier": "^3.8.1",
    "prisma": "^7.4.2",
    "rollup-plugin-visualizer": "^6.0.5",
    "supertest": "^7.2.2",
    "tailwind-merge": "^3.5.0",
    "tailwindcss": "^4.1.17",
    "ts-jest": "^29.4.6",
    "ts-node": "^10.9.2",
    "typescript": "^5.9.3",
    "vite": "^7.3.1",
    "vite-plugin-pwa": "^1.2.0",
    "vite-plugin-static-copy": "^3.2.0"
  },
  "lint-staged": {
    "*.{ts,tsx}": [
      "npx eslint --fix",
      "npx prettier --write",
      "bash -c 'npx tsc --noEmit'"
    ],
    "*.{json,md,yml,yaml}": [
      "npx prettier --write"
    ]
  }
}
